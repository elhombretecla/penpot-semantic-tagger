{"version":3,"file":"main.js","sources":["../src/main.ts"],"sourcesContent":["import { build, type LogLevel } from 'vite';\n\nimport plugin, { type LivePreviewConfig } from './plugin/build.js';\n\ninterface Options {\n  readonly config?: string;\n  readonly root?: string;\n  readonly logLevel?: LogLevel;\n  readonly reload?: boolean;\n  readonly clearScreen?: boolean;\n  readonly mode?: `preview${string}`;\n  readonly base?: string;\n  readonly outDir?: string;\n  readonly host?: string | true;\n  readonly port?: number;\n  readonly strictPort?: true;\n  readonly open?: string | true;\n}\n\nexport const main = async ({\n  config: configFile,\n  reload,\n  root,\n  mode = 'preview',\n  logLevel,\n  clearScreen,\n  base,\n  outDir,\n  ...preview\n}: Options): Promise<void> => {\n  // XXX: This config is used twice, because config file loading depends on the\n  // initial inline config, and this config should also be considered the live\n  // preview \"override\" config.\n  const config: LivePreviewConfig = {\n    root,\n    logLevel,\n    clearScreen,\n    mode,\n    base,\n    build: { outDir },\n    preview,\n  };\n\n  await build({\n    ...config,\n    configFile,\n    plugins: [\n      plugin({ reload, config }),\n    ],\n  });\n};\n"],"names":[],"mappings":";;;AAmBO,MAAM,OAAO,OAAO;AAAA,EACzB,MAAQ,EAAA,UAAA;AAAA,EACR,MAAA;AAAA,EACA,IAAA;AAAA,EACA,IAAO,GAAA,SAAA;AAAA,EACP,QAAA;AAAA,EACA,WAAA;AAAA,EACA,IAAA;AAAA,EACA,MAAA;AAAA,EACA,GAAG,OAAA;AACL,CAA8B,KAAA;AAI5B,EAAA,MAAM,MAA4B,GAAA;AAAA,IAChC,IAAA;AAAA,IACA,QAAA;AAAA,IACA,WAAA;AAAA,IACA,IAAA;AAAA,IACA,IAAA;AAAA,IACA,KAAA,EAAO,EAAE,MAAO,EAAA;AAAA,IAChB,OAAA;AAAA,GACF,CAAA;AAEA,EAAA,MAAM,KAAM,CAAA;AAAA,IACV,GAAG,MAAA;AAAA,IACH,UAAA;AAAA,IACA,OAAS,EAAA;AAAA,MACP,MAAO,CAAA,EAAE,MAAQ,EAAA,MAAA,EAAQ,CAAA;AAAA,KAC3B;AAAA,GACD,CAAA,CAAA;AACH;;;;"}